<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>PferdeWert – Online-Bewertung</title>
  <style>
    body{font-family:sans-serif;max-width:680px;margin:2rem auto}
    h1{margin-bottom:1.5rem}
    label{display:block;margin:0.9rem 0;font-weight:600}
    input,select,textarea{width:100%;padding:0.55rem;border:1px solid #ccc;border-radius:4px}
    textarea[readonly]{background:#f9f9f9}
    .req::after{content:" *";color:#d00}
    button{margin-top:1.8rem;padding:0.8rem 1.6rem;font-size:1rem;background:#0070f3;color:#fff;border:0;border-radius:6px;cursor:pointer}
    button:hover{background:#0059c1}
  </style>
</head>
<body>
<h1>Pferdebewertung anfragen</h1>
<form id="wertForm">
  <label><span class="req">Rasse:</span><br><input type="text" name="rasse" required></label>
  <label><span class="req">Alter (Jahre):</span><br><input type="number" name="alter" required></label>
  <label><span class="req">Geschlecht:</span><br>
    <select name="geschlecht" required>
      <option value="">Bitte wählen</option><option>Stute</option><option>Wallach</option><option>Hengst</option>
    </select></label>
  <label><span class="req">Abstammung:</span><br><input type="text" name="abstammung" required></label>
  <label><span class="req">Stockmaß (cm):</span><br><input type="number" name="stockmass" required></label>
  <label><span class="req">Ausbildungsstand:</span><br><input type="text" name="ausbildung" required></label>
  <label>AKU-Bericht:<br><input type="text" name="aku"></label>
  <label>Erfolge:<br><input type="text" name="erfolge"></label>
  <button type="submit">Bewerten lassen</button>
</form>

<label style="margin-top:2rem;">Ergebnis:<br>
  <textarea id="antwort" rows="6" readonly></textarea>
</label>

<script>
document.getElementById("wertForm").addEventListener("submit", async e => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target).entries());
  const out = document.getElementById("antwort");
  out.value = "Bewertung wird berechnet …";
  try {
    const res = await fetch("/api/bewertung", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const json = await res.json();
    out.value = json.raw_gpt || "Keine gültige Antwort erhalten.";
  } catch (err) {
    out.value = "Fehler – bitte später erneut versuchen.";
    console.error(err);
  }
});
</script>
</body>
</html>
